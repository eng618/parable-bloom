version: '3'

tasks:
  install:
    desc: Install Hugo extended edition via Go
    cmds:
      - go install -tags extended github.com/gohugoio/hugo@latest
    preconditions:
      - sh: command -v go >/dev/null 2>&1
        msg: "Go is not installed."

  serve:
    desc: Start Hugo development server
    dir: tools/hugo-site
    cmds:
      - hugo server -D
    preconditions:
      - sh: command -v hugo >/dev/null 2>&1
        msg: "Hugo is not installed."

  build:
    desc: Build Hugo site to docs/
    dir: tools/hugo-site
    sources:
      - "content/**/*"
      - "layouts/**/*"
      - "static/**/*"
      - "hugo.toml"
    generates:
      - "../../docs/**/*"
    cmds:
      - hugo --minify
    preconditions:
      - sh: command -v hugo >/dev/null 2>&1
        msg: "Hugo is not installed."

  new:
    desc: Create new content page (usage - task hugo:new PAGE=privacy)
    dir: tools/hugo-site
    cmds:
      - hugo new content "{{.PAGE}}.md"
    preconditions:
      - sh: command -v hugo >/dev/null 2>&1
        msg: "Hugo is not installed."
